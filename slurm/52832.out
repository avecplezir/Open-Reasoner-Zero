[2025-07-24 12:13:41,856] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2025-07-24 12:13:47.230 | INFO     | __main__:<module>:136 - --------- config key ---------        ------ value ------
seed                                  42
ref_num_nodes                         4
ref_num_gpus_per_node                 1
reward_num_nodes                      1
reward_num_gpus_per_node              2
actor_num_nodes                       4
actor_num_gpus_per_node               1
critic_num_nodes                      4
critic_num_gpus_per_node              1
colocate_critic_reward                True
colocate_actor_ref                    True
colocate_all                          True
vllm_num_engines                      4
vllm_tensor_parallel_size             1
vllm_sync_backend                     nccl
local_rank                            -1
pretrain                              /home/a/anokhin/links/scratch/Qwen2.5-1.5B
critic_pretrain
reward_pretrain                       <class 'NoneType'>
ckpt_path                             /home/a/anokhin/links/scratch/orz_ckpt/binary_orz_1p5b_ppo_teacher-grpo-4gpu-v1
save_path                             /home/a/anokhin/links/scratch/orz_ckpt/binary_orz_1p5b_ppo_teacher-grpo-4gpu-v1
tensorboard_log_dir                   /home/a/anokhin/links/scratch/orz_logs/binary_orz_1p5b_ppo_teacher-grpo-4gpu-v1
prompt_data                           <class 'omegaconf.listconfig.ListConfig'>
load_checkpoint                       False
zero_stage                            3
bf16                                  True
zpg                                   1
adam_offload                          False
flash_attn                            True
grad_accum_dtype                      <class 'NoneType'>
disable_trace_cache                   False
gradient_checkpointing                True
gradient_checkpointing_use_reentrant  False
disable_fast_tokenizer                False
target_modules                        all-linear
enable_prefix_caching                 True
enable_chunked_prefill                False
max_num_batched_tokens                2048
enforce_eager                         False
gpu_memory_utilization                0.25
eval_steps                            -1
save_steps                            -1
save_interval                         50
actor_learning_rate                   1e-06
critic_learning_rate                  5e-06
num_episodes                          20
max_epochs                            1
prompt_max_len                        2048
generate_max_len                      8000
train_batch_size                      256
micro_train_batch_size                1
rollout_batch_size                    128
micro_rollout_batch_size              128
micro_forward_batch_size              1
policy_update_steps                   1
critic_update_steps                   12
max_len                               8192
max_norm                              1.0
num_warmup_steps                      50
l2                                    0.0
eps_clip                              0.2
value_clip                            0.2
lambd                                 1.0
gamma                                 1.0
normalize_reward                      True
top_p                                 1.0
temperature                           1.0
freezing_actor_steps                  -1
n_samples_per_prompt                  64
kl_target                             <class 'NoneType'>
init_kl_coef                          0
use_kl_estimator_k3                   True
use_abs_kl                            False
use_kl_loss                           True
kl_loss_coef                          0.0
adam_betas                            (0.9, 0.95)
reward_clip_range                     (-10, 10)
use_compute_reward_fn                 True
advantage_normalize                   True
value_head_prefix                     value_head
ref_reward_offload                    False
enable_eval                           True
eval_interval                         10
update_ref_every_epoch                True
use_orm_score                         False
total_num_nodes                       4
exp_name                              binary_orz_1p5b_ppo_teacher-grpo-4gpu-v1
eval_prompt_data                      <class 'omegaconf.listconfig.ListConfig'>
prompt_data_probs                     <class 'omegaconf.listconfig.ListConfig'>
packing_max_len                       10048
top_k                                 -1
stop                                  <class 'omegaconf.listconfig.ListConfig'>
use_grpo                              True
wandb: Currently logged in as: avecplezir (irina-rish). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.21.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in /home/a/anokhin/links/scratch/orz_logs/binary_orz_1p5b_ppo_teacher-grpo-4gpu-v1/wandb/run-20250724_121348-4qmkkzhl
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run binary_orz_1p5b_ppo_teacher-grpo-4gpu-v1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/irina-rish/open-reasoner-zero
wandb: üöÄ View run at https://wandb.ai/irina-rish/open-reasoner-zero/runs/4qmkkzhl
2025-07-24 12:13:51,814	INFO worker.py:1841 -- Started a local Ray instance.
[36m(LLMActor pid=978050)[0m Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
[36m(LLMActor pid=978050)[0m Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:01<00:00,  1.62s/it]
[36m(LLMActor pid=978050)[0m Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:01<00:00,  1.62s/it]
[36m(LLMActor pid=978050)[0m 
[36m(LLMActor pid=978051)[0m 
[36m(LLMActor pid=978052)[0m 
[36m(LLMActor pid=978053)[0m 
2025-07-24 12:14:23.308 | INFO     | orz.ppo.utils:create_vllm_engines:452 - Offloaded all vLLM engines to CPU
2025-07-24 12:14:23.527 | INFO     | playground.orz_7b_ppo:train_dataset:580 - Start processing 1603 dialogues
2025-07-24 12:14:25.592 | INFO     | playground.orz_7b_ppo:train_dataset:589 - Finished processing 1603 dialogues
2025-07-24 12:14:25.595 | INFO     | playground.orz_7b_ppo:eval_dataset:603 - Start processing 687 dialogues
2025-07-24 12:14:26.035 | INFO     | playground.orz_7b_ppo:eval_dataset:612 - Finished processing 687 dialogues
wandb: WARNING Found log directory outside of given root_logdir, dropping given root_logdir for event file in /home/a/anokhin/links/scratch/orz_logs/binary_orz_1p5b_ppo_teacher-grpo-4gpu-v1
[36m(RefRayActorBase pid=979453)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
[36m(LLMActor pid=978053)[0m Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMActor pid=978053)[0m Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:01<00:00,  1.53s/it][32m [repeated 6x across cluster][0m
[36m(PolicyRayActorBase pid=978578)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.[32m [repeated 4x across cluster][0m
[36m(PolicyRayActorBase pid=978578)[0m Using /home/a/anokhin/.cache/torch_extensions/py312_cu122 as PyTorch extensions root...
[36m(PolicyRayActorBase pid=978760)[0m Detected CUDA files, patching ldflags
[36m(PolicyRayActorBase pid=978760)[0m Emitting ninja build file /home/a/anokhin/.cache/torch_extensions/py312_cu122/fused_adam/build.ninja...
[36m(PolicyRayActorBase pid=978760)[0m /home/a/anokhin/envs/reasoner3.12/lib/python3.12/site-packages/torch/utils/cpp_extension.py:1964: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
[36m(PolicyRayActorBase pid=978760)[0m If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
[36m(PolicyRayActorBase pid=978760)[0m   warnings.warn(
[36m(PolicyRayActorBase pid=978760)[0m Building extension module fused_adam...
[36m(PolicyRayActorBase pid=978760)[0m Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
[36m(PolicyRayActorBase pid=978760)[0m Loading extension module fused_adam...
[36m(PolicyRayActorBase pid=978751)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.[32m [repeated 3x across cluster][0m
2025-07-24 12:15:03.735 | INFO     | orz.ppo.trainer:build_models:813 - init policy/ref/critic/reward models done
2025-07-24 12:15:04.477 | INFO     | orz.ppo.trainer:train:74 - Create vllm engine gourps done.
2025-07-24 12:15:07.105 | INFO     | orz.ppo.trainer:train:76 - Sync actor weights to vllm engines, time cost: 2.63s
2025-07-24 12:15:07.412 | INFO     | orz.ppo.trainer:train:80 - Offload policy model to cpu, time cost: 0.31s
math_verify is not installed in this environment
[36m(LLMActor pid=978052)[0m INFO 07-24 12:14:00 __init__.py:207] Automatically detected platform cuda.
[36m(LLMActor pid=978050)[0m INFO 07-24 12:14:14 config.py:549] This model supports multiple tasks: {'reward', 'generate', 'embed', 'classify', 'score'}. Defaulting to 'generate'.
[36m(LLMActor pid=978050)[0m WARNING 07-24 12:14:14 cuda.py:95] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(LLMActor pid=978050)[0m WARNING 07-24 12:14:14 config.py:685] Async output processing is not supported on the current platform type cuda.
[36m(LLMActor pid=978050)[0m INFO 07-24 12:14:14 llm_engine.py:234] Initializing a V0 LLM engine (v0.7.3) with config: model='/home/a/anokhin/links/scratch/Qwen2.5-1.5B', speculative_config=None, tokenizer='/home/a/anokhin/links/scratch/Qwen2.5-1.5B', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=8192, download_dir=None, load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=True, kv_cache_dtype=auto,  device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=45, served_model_name=/home/a/anokhin/links/scratch/Qwen2.5-1.5B, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=True, chunked_prefill_enabled=False, use_async_output_proc=False, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":[],"compile_sizes":[],"cudagraph_capture_sizes":[],"max_capture_size":0}, use_cached_outputs=False, 
[36m(LLMActor pid=978051)[0m INFO 07-24 12:14:00 __init__.py:207] Automatically detected platform cuda.[32m [repeated 3x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(LLMActor pid=978050)[0m INFO 07-24 12:14:15 cuda.py:229] Using Flash Attention backend.
[36m(LLMActor pid=978053)[0m INFO 07-24 12:14:15 config.py:549] This model supports multiple tasks: {'embed', 'reward', 'score', 'generate', 'classify'}. Defaulting to 'generate'.
[36m(LLMActor pid=978050)[0m INFO 07-24 12:14:15 model_runner.py:1110] Starting to load model /home/a/anokhin/links/scratch/Qwen2.5-1.5B...
[36m(LLMActor pid=978051)[0m INFO 07-24 12:14:15 config.py:549] This model supports multiple tasks: {'generate', 'classify', 'score', 'reward', 'embed'}. Defaulting to 'generate'.
[36m(LLMActor pid=978052)[0m INFO 07-24 12:14:15 config.py:549] This model supports multiple tasks: {'classify', 'score', 'embed', 'generate', 'reward'}. Defaulting to 'generate'.
[36m(LLMActor pid=978050)[0m INFO 07-24 12:14:17 model_runner.py:1115] Loading model weights took 2.9105 GB
[36m(LLMActor pid=978050)[0m INFO 07-24 12:14:18 worker.py:267] Memory profiling takes 0.56 seconds
[36m(LLMActor pid=978050)[0m INFO 07-24 12:14:18 worker.py:267] the current vLLM instance can use total_gpu_memory (79.19GiB) x gpu_memory_utilization (0.25) = 19.80GiB
[36m(LLMActor pid=978050)[0m INFO 07-24 12:14:18 worker.py:267] model weights take 2.91GiB; non_torch_memory takes 0.16GiB; PyTorch activation peak memory takes 0.74GiB; the rest of the memory reserved for KV Cache is 15.99GiB.
[36m(LLMActor pid=978050)[0m INFO 07-24 12:14:18 executor_base.py:111] # cuda blocks: 2338, # CPU blocks: 585
[36m(LLMActor pid=978050)[0m INFO 07-24 12:14:18 executor_base.py:116] Maximum concurrency for 8192 tokens per request: 73.06x
[36m(LLMActor pid=978052)[0m WARNING 07-24 12:14:15 cuda.py:95] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used[32m [repeated 3x across cluster][0m
[36m(LLMActor pid=978052)[0m WARNING 07-24 12:14:15 config.py:685] Async output processing is not supported on the current platform type cuda.[32m [repeated 3x across cluster][0m
[36m(LLMActor pid=978052)[0m INFO 07-24 12:14:15 llm_engine.py:234] Initializing a V0 LLM engine (v0.7.3) with config: model='/home/a/anokhin/links/scratch/Qwen2.5-1.5B', speculative_config=None, tokenizer='/home/a/anokhin/links/scratch/Qwen2.5-1.5B', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=8192, download_dir=None, load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=True, kv_cache_dtype=auto,  device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=44, served_model_name=/home/a/anokhin/links/scratch/Qwen2.5-1.5B, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=True, chunked_prefill_enabled=False, use_async_output_proc=False, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":[],"compile_sizes":[],"cudagraph_capture_sizes":[],"max_capture_size":0}, use_cached_outputs=False, [32m [repeated 3x across cluster][0m
[36m(LLMActor pid=978052)[0m INFO 07-24 12:14:16 cuda.py:229] Using Flash Attention backend.[32m [repeated 3x across cluster][0m
[36m(LLMActor pid=978050)[0m INFO 07-24 12:14:21 llm_engine.py:436] init engine (profile, create kv cache, warmup model) took 3.47 seconds
[36m(LLMActor pid=978052)[0m INFO 07-24 12:14:17 model_runner.py:1110] Starting to load model /home/a/anokhin/links/scratch/Qwen2.5-1.5B...[32m [repeated 3x across cluster][0m
[36m(LLMActor pid=978051)[0m INFO 07-24 12:14:19 model_runner.py:1115] Loading model weights took 2.9105 GB[32m [repeated 3x across cluster][0m
[36m(pid=978578)[0m [2025-07-24 12:14:28,955] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(LLMActor pid=978051)[0m INFO 07-24 12:14:20 worker.py:267] Memory profiling takes 0.41 seconds[32m [repeated 3x across cluster][0m
[36m(LLMActor pid=978051)[0m INFO 07-24 12:14:20 worker.py:267] the current vLLM instance can use total_gpu_memory (79.19GiB) x gpu_memory_utilization (0.25) = 19.80GiB[32m [repeated 3x across cluster][0m
[36m(LLMActor pid=978051)[0m INFO 07-24 12:14:20 worker.py:267] model weights take 2.91GiB; non_torch_memory takes 0.16GiB; PyTorch activation peak memory takes 0.74GiB; the rest of the memory reserved for KV Cache is 15.99GiB.[32m [repeated 3x across cluster][0m
[36m(LLMActor pid=978051)[0m INFO 07-24 12:14:20 executor_base.py:111] # cuda blocks: 2338, # CPU blocks: 585[32m [repeated 3x across cluster][0m
[36m(LLMActor pid=978051)[0m INFO 07-24 12:14:20 executor_base.py:116] Maximum concurrency for 8192 tokens per request: 73.06x[32m [repeated 3x across cluster][0m
[36m(LLMActor pid=978051)[0m INFO 07-24 12:14:23 llm_engine.py:436] init engine (profile, create kv cache, warmup model) took 3.54 seconds[32m [repeated 3x across cluster][0m
[36m(pid=978751)[0m [2025-07-24 12:14:36,819] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(pid=978750)[0m [2025-07-24 12:14:37,017] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:41,221] [INFO] [comm.py:652:init_distributed] cdb=None
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:41,221] [INFO] [comm.py:683:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[36m(pid=979453)[0m [2025-07-24 12:14:43,997] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)[32m [repeated 3x across cluster][0m
[36m(RefRayActorBase pid=979453)[0m [2025-07-24 12:14:48,119] [INFO] [comm.py:652:init_distributed] cdb=None
[36m(RefRayActorBase pid=979453)[0m [2025-07-24 12:14:48,238] [INFO] [config.py:733:__init__] Config mesh_device None world_size = 4
[36m(RefRayActorBase pid=979454)[0m [2025-07-24 12:14:48,437] [INFO] [comm.py:652:init_distributed] cdb=None
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:51,865] [INFO] [partition_parameters.py:348:__exit__] finished initializing model - num_params = 339, num_elems = 1.78B
[36m(pid=979452)[0m [2025-07-24 12:14:44,627] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)[32m [repeated 2x across cluster][0m
[36m(RefRayActorBase pid=979454)[0m [2025-07-24 12:14:53,387] [INFO] [config.py:733:__init__] Config mesh_device None world_size = 4[32m [repeated 4x across cluster][0m
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,477] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed info: version=0.16.0, git-hash=unknown, git-branch=unknown
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,478] [INFO] [comm.py:677:init_distributed] Distributed backend already initialized
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,486] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,487] [INFO] [logging.py:128:log_dist] [Rank 0] Creating ZeRO Offload
[36m(RefRayActorBase pid=979452)[0m [2025-07-24 12:14:48,586] [INFO] [comm.py:652:init_distributed] cdb=None
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,688] [INFO] [utils.py:781:see_memory_usage] DeepSpeedZeRoOffload initialize [begin]
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,689] [INFO] [utils.py:782:see_memory_usage] MA 0.73 GB         Max_MA 1.71 GB         CA 1.75 GB         Max_CA 2 GB 
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,689] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 52.11 GB, percent = 10.4%
[36m(RefRayActorBase pid=978753)[0m Parameter Offload: Total persistent parameters: 144896 in 141 params
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,834] [INFO] [utils.py:781:see_memory_usage] DeepSpeedZeRoOffload initialize [end]
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,834] [INFO] [utils.py:782:see_memory_usage] MA 0.73 GB         Max_MA 0.73 GB         CA 1.75 GB         Max_CA 2 GB 
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,835] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 52.11 GB, percent = 10.4%
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,835] [INFO] [config.py:999:print] DeepSpeedEngine configuration:
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,836] [INFO] [config.py:1003:print]   activation_checkpointing_config  {
[36m(RefRayActorBase pid=978753)[0m     "partition_activations": false, 
[36m(RefRayActorBase pid=978753)[0m     "contiguous_memory_optimization": false, 
[36m(RefRayActorBase pid=978753)[0m     "cpu_checkpointing": false, 
[36m(RefRayActorBase pid=978753)[0m     "number_checkpoints": null, 
[36m(RefRayActorBase pid=978753)[0m     "synchronize_checkpoint_boundary": false, 
[36m(RefRayActorBase pid=978753)[0m     "profile": false
[36m(RefRayActorBase pid=978753)[0m }
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,836] [INFO] [config.py:1003:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True, 'use_gds': False}
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,836] [INFO] [config.py:1003:print]   amp_enabled .................. False
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,836] [INFO] [config.py:1003:print]   amp_params ................... False
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,836] [INFO] [config.py:1003:print]   autotuning_config ............ {
[36m(RefRayActorBase pid=978753)[0m     "enabled": false, 
[36m(RefRayActorBase pid=978753)[0m     "start_step": null, 
[36m(RefRayActorBase pid=978753)[0m     "end_step": null, 
[36m(RefRayActorBase pid=978753)[0m     "metric_path": null, 
[36m(RefRayActorBase pid=978753)[0m     "arg_mappings": null, 
[36m(RefRayActorBase pid=978753)[0m     "metric": "throughput", 
[36m(RefRayActorBase pid=978753)[0m     "model_info": null, 
[36m(RefRayActorBase pid=978753)[0m     "results_dir": "autotuning_results", 
[36m(RefRayActorBase pid=978753)[0m     "exps_dir": "autotuning_exps", 
[36m(RefRayActorBase pid=978753)[0m     "overwrite": true, 
[36m(RefRayActorBase pid=978753)[0m     "fast": true, 
[36m(RefRayActorBase pid=978753)[0m     "start_profile_step": 3, 
[36m(RefRayActorBase pid=978753)[0m     "end_profile_step": 5, 
[36m(RefRayActorBase pid=978753)[0m     "tuner_type": "gridsearch", 
[36m(RefRayActorBase pid=978753)[0m     "tuner_early_stopping": 5, 
[36m(RefRayActorBase pid=978753)[0m     "tuner_num_trials": 50, 
[36m(RefRayActorBase pid=978753)[0m     "model_info_path": null, 
[36m(RefRayActorBase pid=978753)[0m     "mp_size": 1, 
[36m(RefRayActorBase pid=978753)[0m     "max_train_batch_size": null, 
[36m(RefRayActorBase pid=978753)[0m     "min_train_batch_size": 1, 
[36m(RefRayActorBase pid=978753)[0m     "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
[36m(RefRayActorBase pid=978753)[0m     "min_train_micro_batch_size_per_gpu": 1, 
[36m(RefRayActorBase pid=978753)[0m     "num_tuning_micro_batch_sizes": 3
[36m(RefRayActorBase pid=978753)[0m }
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,836] [INFO] [config.py:1003:print]   bfloat16_enabled ............. True
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,836] [INFO] [config.py:1003:print]   bfloat16_immediate_grad_update  False
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,836] [INFO] [config.py:1003:print]   checkpoint_parallel_write_pipeline  False
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,836] [INFO] [config.py:1003:print]   checkpoint_tag_validation_enabled  True
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,836] [INFO] [config.py:1003:print]   checkpoint_tag_validation_fail  False
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,836] [INFO] [config.py:1003:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x711184999a90>
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,836] [INFO] [config.py:1003:print]   communication_data_type ...... None
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,836] [INFO] [config.py:1003:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,836] [INFO] [config.py:1003:print]   curriculum_enabled_legacy .... False
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,836] [INFO] [config.py:1003:print]   curriculum_params_legacy ..... False
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,836] [INFO] [config.py:1003:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,836] [INFO] [config.py:1003:print]   data_efficiency_enabled ...... False
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,836] [INFO] [config.py:1003:print]   dataloader_drop_last ......... False
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,836] [INFO] [config.py:1003:print]   disable_allgather ............ False
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,836] [INFO] [config.py:1003:print]   dump_state ................... False
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,836] [INFO] [config.py:1003:print]   dynamic_loss_scale_args ...... None
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,836] [INFO] [config.py:1003:print]   eigenvalue_enabled ........... False
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,836] [INFO] [config.py:1003:print]   eigenvalue_gas_boundary_resolution  1
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,836] [INFO] [config.py:1003:print]   eigenvalue_layer_name ........ bert.encoder.layer
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,836] [INFO] [config.py:1003:print]   eigenvalue_layer_num ......... 0
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,836] [INFO] [config.py:1003:print]   eigenvalue_max_iter .......... 100
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   eigenvalue_stability ......... 1e-06
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   eigenvalue_tol ............... 0.01
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   eigenvalue_verbose ........... False
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   elasticity_enabled ........... False
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   flops_profiler_config ........ {
[36m(RefRayActorBase pid=978753)[0m     "enabled": false, 
[36m(RefRayActorBase pid=978753)[0m     "recompute_fwd_factor": 0.0, 
[36m(RefRayActorBase pid=978753)[0m     "profile_step": 1, 
[36m(RefRayActorBase pid=978753)[0m     "module_depth": -1, 
[36m(RefRayActorBase pid=978753)[0m     "top_modules": 1, 
[36m(RefRayActorBase pid=978753)[0m     "detailed": true, 
[36m(RefRayActorBase pid=978753)[0m     "output_file": null
[36m(RefRayActorBase pid=978753)[0m }
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   fp16_auto_cast ............... None
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   fp16_enabled ................. False
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   fp16_master_weights_and_gradients  False
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   global_rank .................. 0
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   grad_accum_dtype ............. None
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   gradient_accumulation_steps .. 1
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   gradient_clipping ............ 1.0
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   gradient_predivide_factor .... 1.0
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   graph_harvesting ............. False
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   initial_dynamic_scale ........ 1
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   load_universal_checkpoint .... False
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   loss_scale ................... 1.0
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   memory_breakdown ............. False
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   mics_hierarchial_params_gather  False
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   mics_shard_size .............. -1
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName')
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   nebula_config ................ {
[36m(RefRayActorBase pid=978753)[0m     "enabled": false, 
[36m(RefRayActorBase pid=978753)[0m     "persistent_storage_path": null, 
[36m(RefRayActorBase pid=978753)[0m     "persistent_time_interval": 100, 
[36m(RefRayActorBase pid=978753)[0m     "num_of_version_in_retention": 2, 
[36m(RefRayActorBase pid=978753)[0m     "enable_nebula_load": true, 
[36m(RefRayActorBase pid=978753)[0m     "load_path": null
[36m(RefRayActorBase pid=978753)[0m }
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   optimizer_legacy_fusion ...... False
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   optimizer_name ............... None
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   optimizer_params ............. None
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   pld_enabled .................. False
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   pld_params ................... False
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   prescale_gradients ........... False
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   scheduler_name ............... None
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   scheduler_params ............. None
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   seq_parallel_communication_data_type  torch.float32
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   sparse_attention ............. None
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   sparse_gradients_enabled ..... False
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   steps_per_print .............. 100
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   timers_config ................ enabled=True synchronized=True
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   train_batch_size ............. 4
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   train_micro_batch_size_per_gpu  1
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   use_data_before_expert_parallel_  False
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   use_node_local_storage ....... False
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   wall_clock_breakdown ......... False
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   weight_quantization_config ... None
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   world_size ................... 4
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   zero_allow_untested_optimizer  False
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   zero_config .................. stage=3 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=DeepSpeedZeroOffloadParamConfig(device='cpu', nvme_path=None, buffer_count=5, buffer_size=100000000, max_in_cpu=1000000000, pin_memory=True) offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50000000 param_persistence_threshold=100000 model_persistence_threshold=9223372036854775807 max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=False module_granularity_threshold=0 use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   zero_enabled ................. True
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   zero_force_ds_cpu_optimizer .. True
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:1003:print]   zero_optimization_stage ...... 3
[36m(RefRayActorBase pid=978753)[0m [2025-07-24 12:14:53,837] [INFO] [config.py:989:print_user_config]   json = {
[36m(RefRayActorBase pid=978753)[0m     "steps_per_print": 100, 
[36m(RefRayActorBase pid=978753)[0m     "zero_optimization": {
[36m(RefRayActorBase pid=978753)[0m         "stage": 3, 
[36m(RefRayActorBase pid=978753)[0m         "stage3_param_persistence_threshold": "auto", 
[36m(RefRayActorBase pid=978753)[0m         "offload_param": {
[36m(RefRayActorBase pid=978753)[0m             "device": "cpu", 
[36m(RefRayActorBase pid=978753)[0m             "pin_memory": true
[36m(RefRayActorBase pid=978753)[0m         }
[36m(RefRayActorBase pid=978753)[0m     }, 
[36m(RefRayActorBase pid=978753)[0m     "bf16": {
[36m(RefRayActorBase pid=978753)[0m         "enabled": true
[36m(RefRayActorBase pid=978753)[0m     }, 
[36m(RefRayActorBase pid=978753)[0m     "gradient_clipping": 1.0, 
[36m(RefRayActorBase pid=978753)[0m     "prescale_gradients": false, 
[36m(RefRayActorBase pid=978753)[0m     "wall_clock_breakdown": false, 
[36m(RefRayActorBase pid=978753)[0m     "train_micro_batch_size_per_gpu": 1, 
[36m(RefRayActorBase pid=978753)[0m     "gradient_accumulation_steps": 1
[36m(RefRayActorBase pid=978753)[0m }
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:14:53,973] [INFO] [comm.py:652:init_distributed] cdb=None
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:14:53,973] [INFO] [comm.py:683:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:14:57,362] [INFO] [partition_parameters.py:348:__exit__] finished initializing model - num_params = 339, num_elems = 1.78B
[36m(PolicyRayActorBase pid=978760)[0m ninja: no work to do.
[36m(PolicyRayActorBase pid=978760)[0m Time to load fused_adam op: 1.107302188873291 seconds
[36m(PolicyRayActorBase pid=978760)[0m [2025-07-24 12:14:59,931] [INFO] [config.py:733:__init__] Config mesh_device None world_size = 4[32m [repeated 8x across cluster][0m
[36m(PolicyRayActorBase pid=978751)[0m [2025-07-24 12:14:53,974] [INFO] [comm.py:652:init_distributed] cdb=None[32m [repeated 3x across cluster][0m
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:14:59,996] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed info: version=0.16.0, git-hash=unknown, git-branch=unknown
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:14:59,996] [INFO] [comm.py:677:init_distributed] Distributed backend already initialized
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:00,007] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:00,008] [INFO] [logging.py:128:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:00,008] [INFO] [logging.py:128:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:00,021] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:00,021] [INFO] [utils.py:59:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:00,021] [INFO] [logging.py:128:log_dist] [Rank 0] Creating fp16 ZeRO stage 3 optimizer, MiCS is enabled False, Hierarchical params gather False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:00,021] [INFO] [logging.py:128:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 3 optimizer
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:00,228] [INFO] [utils.py:781:see_memory_usage] Stage 3 initialize beginning
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:00,229] [INFO] [utils.py:782:see_memory_usage] MA 0.73 GB         Max_MA 1.6 GB         CA 1.75 GB         Max_CA 2 GB 
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:00,229] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 54.49 GB, percent = 10.8%
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:00,230] [INFO] [stage3.py:167:__init__] Reduce bucket size 500000000
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:00,230] [INFO] [stage3.py:168:__init__] Prefetch bucket size 50000000
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:00,378] [INFO] [utils.py:781:see_memory_usage] DeepSpeedZeRoOffload initialize [begin]
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:00,379] [INFO] [utils.py:782:see_memory_usage] MA 0.73 GB         Max_MA 0.73 GB         CA 1.75 GB         Max_CA 2 GB 
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:00,379] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 54.49 GB, percent = 10.8%
[36m(PolicyRayActorBase pid=978578)[0m Parameter Offload: Total persistent parameters: 144896 in 141 params
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:00,521] [INFO] [utils.py:781:see_memory_usage] DeepSpeedZeRoOffload initialize [end]
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:00,522] [INFO] [utils.py:782:see_memory_usage] MA 0.73 GB         Max_MA 0.73 GB         CA 1.75 GB         Max_CA 2 GB 
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:00,522] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 54.49 GB, percent = 10.8%
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:00,651] [INFO] [utils.py:781:see_memory_usage] Before creating fp16 partitions
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:00,652] [INFO] [utils.py:782:see_memory_usage] MA 0.73 GB         Max_MA 0.73 GB         CA 1.75 GB         Max_CA 2 GB 
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:00,652] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 54.49 GB, percent = 10.8%
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:01,547] [INFO] [utils.py:781:see_memory_usage] After creating fp16 partitions: 2
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:01,548] [INFO] [utils.py:782:see_memory_usage] MA 0.72 GB         Max_MA 0.73 GB         CA 0.72 GB         Max_CA 2 GB 
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:01,548] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 57.24 GB, percent = 11.4%
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:01,678] [INFO] [utils.py:781:see_memory_usage] Before creating fp32 partitions
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:01,678] [INFO] [utils.py:782:see_memory_usage] MA 0.72 GB         Max_MA 0.72 GB         CA 0.72 GB         Max_CA 1 GB 
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:01,678] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 57.24 GB, percent = 11.4%
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:01,810] [INFO] [utils.py:781:see_memory_usage] After creating fp32 partitions
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:01,810] [INFO] [utils.py:782:see_memory_usage] MA 2.16 GB         Max_MA 2.88 GB         CA 2.88 GB         Max_CA 3 GB 
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:01,810] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 57.24 GB, percent = 11.4%
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:01,938] [INFO] [utils.py:781:see_memory_usage] Before initializing optimizer states
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:01,939] [INFO] [utils.py:782:see_memory_usage] MA 2.16 GB         Max_MA 2.16 GB         CA 2.88 GB         Max_CA 3 GB 
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:01,939] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 57.21 GB, percent = 11.4%
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,068] [INFO] [utils.py:781:see_memory_usage] After initializing optimizer states
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,069] [INFO] [utils.py:782:see_memory_usage] MA 2.16 GB         Max_MA 3.59 GB         CA 4.32 GB         Max_CA 4 GB 
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,069] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 57.2 GB, percent = 11.4%
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,069] [INFO] [stage3.py:525:_setup_for_real_optimizer] optimizer state initialized
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,295] [INFO] [utils.py:781:see_memory_usage] After initializing ZeRO optimizer
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,296] [INFO] [utils.py:782:see_memory_usage] MA 4.53 GB         Max_MA 5.39 GB         CA 5.76 GB         Max_CA 6 GB 
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,296] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 57.21 GB, percent = 11.4%
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,296] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Final Optimizer = DeepSpeedZeroOptimizer_Stage3
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,296] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,296] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed LR Scheduler = <torch.optim.lr_scheduler.LambdaLR object at 0x7b0ff5353e30>
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,296] [INFO] [logging.py:128:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0, 0.0], mom=[(0.9, 0.95), (0.9, 0.95)]
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,297] [INFO] [config.py:999:print] DeepSpeedEngine configuration:
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,297] [INFO] [config.py:1003:print]   activation_checkpointing_config  {
[36m(PolicyRayActorBase pid=978578)[0m     "partition_activations": false, 
[36m(PolicyRayActorBase pid=978578)[0m     "contiguous_memory_optimization": false, 
[36m(PolicyRayActorBase pid=978578)[0m     "cpu_checkpointing": false, 
[36m(PolicyRayActorBase pid=978578)[0m     "number_checkpoints": null, 
[36m(PolicyRayActorBase pid=978578)[0m     "synchronize_checkpoint_boundary": false, 
[36m(PolicyRayActorBase pid=978578)[0m     "profile": false
[36m(PolicyRayActorBase pid=978578)[0m }
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,297] [INFO] [config.py:1003:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True, 'use_gds': False}
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,297] [INFO] [config.py:1003:print]   amp_enabled .................. False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,297] [INFO] [config.py:1003:print]   amp_params ................... False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   autotuning_config ............ {
[36m(PolicyRayActorBase pid=978578)[0m     "enabled": false, 
[36m(PolicyRayActorBase pid=978578)[0m     "start_step": null, 
[36m(PolicyRayActorBase pid=978578)[0m     "end_step": null, 
[36m(PolicyRayActorBase pid=978578)[0m     "metric_path": null, 
[36m(PolicyRayActorBase pid=978578)[0m     "arg_mappings": null, 
[36m(PolicyRayActorBase pid=978578)[0m     "metric": "throughput", 
[36m(PolicyRayActorBase pid=978578)[0m     "model_info": null, 
[36m(PolicyRayActorBase pid=978578)[0m     "results_dir": "autotuning_results", 
[36m(PolicyRayActorBase pid=978578)[0m     "exps_dir": "autotuning_exps", 
[36m(PolicyRayActorBase pid=978578)[0m     "overwrite": true, 
[36m(PolicyRayActorBase pid=978578)[0m     "fast": true, 
[36m(PolicyRayActorBase pid=978578)[0m     "start_profile_step": 3, 
[36m(PolicyRayActorBase pid=978578)[0m     "end_profile_step": 5, 
[36m(PolicyRayActorBase pid=978578)[0m     "tuner_type": "gridsearch", 
[36m(PolicyRayActorBase pid=978578)[0m     "tuner_early_stopping": 5, 
[36m(PolicyRayActorBase pid=978578)[0m     "tuner_num_trials": 50, 
[36m(PolicyRayActorBase pid=978578)[0m     "model_info_path": null, 
[36m(PolicyRayActorBase pid=978578)[0m     "mp_size": 1, 
[36m(PolicyRayActorBase pid=978578)[0m     "max_train_batch_size": null, 
[36m(PolicyRayActorBase pid=978578)[0m     "min_train_batch_size": 1, 
[36m(PolicyRayActorBase pid=978578)[0m     "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
[36m(PolicyRayActorBase pid=978578)[0m     "min_train_micro_batch_size_per_gpu": 1, 
[36m(PolicyRayActorBase pid=978578)[0m     "num_tuning_micro_batch_sizes": 3
[36m(PolicyRayActorBase pid=978578)[0m }
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   bfloat16_enabled ............. True
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   bfloat16_immediate_grad_update  False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   checkpoint_parallel_write_pipeline  False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   checkpoint_tag_validation_enabled  True
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   checkpoint_tag_validation_fail  False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7b0ff5351910>
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   communication_data_type ...... None
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   curriculum_enabled_legacy .... False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   curriculum_params_legacy ..... False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   data_efficiency_enabled ...... False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   dataloader_drop_last ......... False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   disable_allgather ............ False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   dump_state ................... False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   dynamic_loss_scale_args ...... None
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   eigenvalue_enabled ........... False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   eigenvalue_gas_boundary_resolution  1
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   eigenvalue_layer_name ........ bert.encoder.layer
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   eigenvalue_layer_num ......... 0
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   eigenvalue_max_iter .......... 100
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   eigenvalue_stability ......... 1e-06
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   eigenvalue_tol ............... 0.01
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   eigenvalue_verbose ........... False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   elasticity_enabled ........... False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   flops_profiler_config ........ {
[36m(PolicyRayActorBase pid=978578)[0m     "enabled": false, 
[36m(PolicyRayActorBase pid=978578)[0m     "recompute_fwd_factor": 0.0, 
[36m(PolicyRayActorBase pid=978578)[0m     "profile_step": 1, 
[36m(PolicyRayActorBase pid=978578)[0m     "module_depth": -1, 
[36m(PolicyRayActorBase pid=978578)[0m     "top_modules": 1, 
[36m(PolicyRayActorBase pid=978578)[0m     "detailed": true, 
[36m(PolicyRayActorBase pid=978578)[0m     "output_file": null
[36m(PolicyRayActorBase pid=978578)[0m }
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   fp16_auto_cast ............... None
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   fp16_enabled ................. False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   fp16_master_weights_and_gradients  False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   global_rank .................. 0
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   grad_accum_dtype ............. fp32
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   gradient_accumulation_steps .. 1
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   gradient_clipping ............ 1.0
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   gradient_predivide_factor .... 1.0
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   graph_harvesting ............. False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   initial_dynamic_scale ........ 1
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   load_universal_checkpoint .... False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   loss_scale ................... 1.0
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   memory_breakdown ............. False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   mics_hierarchial_params_gather  False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   mics_shard_size .............. -1
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName')
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   nebula_config ................ {
[36m(PolicyRayActorBase pid=978578)[0m     "enabled": false, 
[36m(PolicyRayActorBase pid=978578)[0m     "persistent_storage_path": null, 
[36m(PolicyRayActorBase pid=978578)[0m     "persistent_time_interval": 100, 
[36m(PolicyRayActorBase pid=978578)[0m     "num_of_version_in_retention": 2, 
[36m(PolicyRayActorBase pid=978578)[0m     "enable_nebula_load": true, 
[36m(PolicyRayActorBase pid=978578)[0m     "load_path": null
[36m(PolicyRayActorBase pid=978578)[0m }
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   optimizer_legacy_fusion ...... False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   optimizer_name ............... None
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   optimizer_params ............. None
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   pld_enabled .................. False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   pld_params ................... False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,298] [INFO] [config.py:1003:print]   prescale_gradients ........... False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,299] [INFO] [config.py:1003:print]   scheduler_name ............... None
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,299] [INFO] [config.py:1003:print]   scheduler_params ............. None
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,299] [INFO] [config.py:1003:print]   seq_parallel_communication_data_type  torch.float32
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,299] [INFO] [config.py:1003:print]   sparse_attention ............. None
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,299] [INFO] [config.py:1003:print]   sparse_gradients_enabled ..... False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,299] [INFO] [config.py:1003:print]   steps_per_print .............. 100
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,299] [INFO] [config.py:1003:print]   timers_config ................ enabled=True synchronized=True
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,299] [INFO] [config.py:1003:print]   train_batch_size ............. 4
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,299] [INFO] [config.py:1003:print]   train_micro_batch_size_per_gpu  1
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,299] [INFO] [config.py:1003:print]   use_data_before_expert_parallel_  False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,299] [INFO] [config.py:1003:print]   use_node_local_storage ....... False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,299] [INFO] [config.py:1003:print]   wall_clock_breakdown ......... False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,299] [INFO] [config.py:1003:print]   weight_quantization_config ... None
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,299] [INFO] [config.py:1003:print]   world_size ................... 4
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,299] [INFO] [config.py:1003:print]   zero_allow_untested_optimizer  False
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,299] [INFO] [config.py:1003:print]   zero_config .................. stage=3 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=DeepSpeedZeroOffloadParamConfig(device='none', nvme_path=None, buffer_count=5, buffer_size=100000000, max_in_cpu=1000000000, pin_memory=False) offload_optimizer=DeepSpeedZeroOffloadOptimizerConfig(device='none', nvme_path=None, buffer_count=4, pin_memory=True, pipeline_read=False, pipeline_write=False, fast_init=False, ratio=1.0) sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50000000 param_persistence_threshold=100000 model_persistence_threshold=9223372036854775807 max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=False module_granularity_threshold=0 use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,299] [INFO] [config.py:1003:print]   zero_enabled ................. True
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,299] [INFO] [config.py:1003:print]   zero_force_ds_cpu_optimizer .. True
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,299] [INFO] [config.py:1003:print]   zero_optimization_stage ...... 3
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:15:02,299] [INFO] [config.py:989:print_user_config]   json = {
[36m(PolicyRayActorBase pid=978578)[0m     "steps_per_print": 100, 
[36m(PolicyRayActorBase pid=978578)[0m     "zero_optimization": {
[36m(PolicyRayActorBase pid=978578)[0m         "stage": 3, 
[36m(PolicyRayActorBase pid=978578)[0m         "offload_param": {
[36m(PolicyRayActorBase pid=978578)[0m             "device": "none"
[36m(PolicyRayActorBase pid=978578)[0m         }, 
[36m(PolicyRayActorBase pid=978578)[0m         "offload_optimizer": {
[36m(PolicyRayActorBase pid=978578)[0m             "device": "none", 
[36m(PolicyRayActorBase pid=978578)[0m             "pin_memory": true
[36m(PolicyRayActorBase pid=978578)[0m         }, 
[36m(PolicyRayActorBase pid=978578)[0m         "sub_group_size": "auto", 
[36m(PolicyRayActorBase pid=978578)[0m         "stage3_max_live_parameters": "auto", 
[36m(PolicyRayActorBase pid=978578)[0m         "stage3_max_reuse_distance": "auto", 
[36m(PolicyRayActorBase pid=978578)[0m         "stage3_param_persistence_threshold": "auto", 
[36m(PolicyRayActorBase pid=978578)[0m         "stage3_prefetch_bucket_size": "auto", 
[36m(PolicyRayActorBase pid=978578)[0m         "reduce_bucket_size": "auto", 
[36m(PolicyRayActorBase pid=978578)[0m         "zero_hpz_partition_size": 1, 
[36m(PolicyRayActorBase pid=978578)[0m         "zero_quantized_weights": false, 
[36m(PolicyRayActorBase pid=978578)[0m         "zero_quantized_gradients": false
[36m(PolicyRayActorBase pid=978578)[0m     }, 
[36m(PolicyRayActorBase pid=978578)[0m     "bf16": {
[36m(PolicyRayActorBase pid=978578)[0m         "enabled": true
[36m(PolicyRayActorBase pid=978578)[0m     }, 
[36m(PolicyRayActorBase pid=978578)[0m     "gradient_clipping": 1.0, 
[36m(PolicyRayActorBase pid=978578)[0m     "prescale_gradients": false, 
[36m(PolicyRayActorBase pid=978578)[0m     "wall_clock_breakdown": false, 
[36m(PolicyRayActorBase pid=978578)[0m     "data_types": {
[36m(PolicyRayActorBase pid=978578)[0m         "grad_accum_dtype": "fp32"
[36m(PolicyRayActorBase pid=978578)[0m     }, 
[36m(PolicyRayActorBase pid=978578)[0m     "train_micro_batch_size_per_gpu": 1, 
[36m(PolicyRayActorBase pid=978578)[0m     "gradient_accumulation_steps": 1
[36m(PolicyRayActorBase pid=978578)[0m }
[36m(LLMActor pid=978053)[0m init_process_group: master_address=10.224.3.59, master_port=59837,  rank=1, world_size=5, group_name=openrlhf
[36m(PolicyRayActorBase pid=978578)[0m WARNING:using --vllm_sync_backend=gloo for vLLM version > 0.4.2 (or export NCCL_P2P_DISABLE=1)
[36m(PolicyRayActorBase pid=978578)[0m Broadcast actor weights to vllm engines done
[36m(PolicyRayActorBase pid=978578)[0m Time to load fused_adam op: 1.1097776889801025 seconds[32m [repeated 3x across cluster][0m
[36m(PolicyRayActorBase pid=978578)[0m [2025-07-24 12:14:59,996] [INFO] [config.py:733:__init__] Config mesh_device None world_size = 4[32m [repeated 3x across cluster][0m
Episode [1/20]:   0%|          | 0/13 [00:00<?, ?it/s]2025-07-24 12:15:07.544 | INFO     | playground.orz_7b_ppo:eval:428 - Start evaluating on val set
[36m(LLMActor pid=978051)[0m Processed prompts:   0%|          | 0/172 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(PolicyRayActorBase pid=978751)[0m Using /home/a/anokhin/.cache/torch_extensions/py312_cu122 as PyTorch extensions root...[32m [repeated 3x across cluster][0m
[36m(PolicyRayActorBase pid=978578)[0m Loading extension module fused_adam...[32m [repeated 3x across cluster][0m
[36m(LLMActor pid=978053)[0m Processed prompts:   1%|          | 1/172 [00:00<00:56,  3.03it/s, est. speed input: 541.59 toks/s, output: 21.18 toks/s]
[36m(LLMActor pid=978053)[0m Processed prompts:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 159/172 [00:04<00:00, 20.62it/s, est. speed input: 6341.68 toks/s, output: 2776.70 toks/s]
[36m(LLMActor pid=978053)[0m Processed prompts:   0%|          | 0/172 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMActor pid=978050)[0m Processed prompts:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 153/171 [00:05<00:01, 12.93it/s, est. speed input: 5304.02 toks/s, output: 2435.27 toks/s][32m [repeated 110x across cluster][0m
[36m(LLMActor pid=978050)[0m Processed prompts: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 171/171 [00:09<00:00,  1.89it/s, est. speed input: 3153.94 toks/s, output: 1934.10 toks/s]Processed prompts: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 171/171 [00:09<00:00, 17.40it/s, est. speed input: 3153.94 toks/s, output: 1934.10 toks/s]
[36m(LLMActor pid=978052)[0m Processed prompts:  99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 170/172 [00:08<00:00,  2.70it/s, est. speed input: 3441.92 toks/s, output: 1817.12 toks/s][32m [repeated 30x across cluster][0m
[36m(LLMActor pid=978051)[0m Processed prompts:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 155/172 [00:05<00:01,  8.93it/s, est. speed input: 5079.05 toks/s, output: 2278.18 toks/s][32m [repeated 2x across cluster][0m
2025-07-24 12:15:23.281 | INFO     | playground.orz_7b_ppo:eval:533 - strategyqa_test/response_len_in_char: 494.2853,strategyqa_test/accuracy: 0.3115,eval_accuracy: 0.3115
2025-07-24 12:15:23.900 | INFO     | orz.ppo.trainer:make_experience:231 - start generation from teacher prompts
2025-07-24 12:17:53.658 | INFO     | orz.ppo.trainer:make_experience:234 - generate local rollout batch done
2025-07-24 12:17:53.750 | INFO     | orz.ppo.trainer:make_experience:238 - Offload vllm engines to cpu, time cost: 0.09s
2025-07-24 12:17:53.751 | INFO     | orz.ppo.trainer:make_experience:218 - Generate sequences via vllm engines, time cost: 149.85s
2025-07-24 12:18:12.255 | INFO     | playground.orz_7b_ppo:custom_reward_fn:322 - avg_non_stop_count: 0.0001,avg_repeat_score: 0.0154,avg_reflection_pattern_score: 0.0088,avg_pass_at_n: 1.0000,avg_num_tokens: 121.8113,std_num_tokens: 163.4593,avg_correct_num_tokens: 110.7291,std_correct_num_tokens: 100.2832,avg_incorrect_num_tokens: 138.6373,std_incorrect_num_tokens: 227.0407
2025-07-24 12:18:12.715 | INFO     | orz.ppo.trainer:make_experience:249 - Calculate custom rewards, time cost: 18.96s
2025-07-24 12:18:16.074 | INFO     | orz.ppo.trainer:make_experience:265 - Packing samples, time cost: 3.36s
2025-07-24 12:18:46.388 | INFO     | orz.ppo.trainer:make_experience:303 - experiences size: 236
2025-07-24 12:18:46.389 | INFO     | orz.ppo.trainer:make_experience:290 - Inference and calculate values, log probs, rewards, kl divergence, time cost: 30.31s
2025-07-24 12:18:47.751 | INFO     | orz.ppo.trainer:make_experience:377 - Calculate advantages and returns, time cost: 0.71s
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/a/anokhin/Open-Reasoner-Zero/playground/binary_orz_1p5b_ppo.py", line 152, in <module>
    asyncio.run(exp.run())
  File "/cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v4/Compiler/gcccore/python/3.12.4/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v4/Compiler/gcccore/python/3.12.4/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v4/Compiler/gcccore/python/3.12.4/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/a/anokhin/Open-Reasoner-Zero/orz/exps/examples/ppo/ppo_base_exp.py", line 274, in run
    await self.trainer.train()
  File "/home/a/anokhin/Open-Reasoner-Zero/orz/ppo/trainer.py", line 109, in train
    await self.make_experience(rand_prompts)
  File "/home/a/anokhin/Open-Reasoner-Zero/orz/ppo/trainer.py", line 392, in make_experience
    avg_kl_max += metrics["avg_kl_max"]
  File "/home/a/anokhin/envs/reasoner3.12/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/a/anokhin/Open-Reasoner-Zero/orz/ppo/replay_buffer.py", line 334, in append
    items = split_experience_batch(experience)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/a/anokhin/Open-Reasoner-Zero/orz/ppo/replay_buffer.py", line 194, in split_experience_batch
    assert vv.numel() == 1, f"info[{k}] must be a scalar tensor, but got {vv.shape}"
           ^^^^^^^^^^^^^^^
AssertionError: info[teacher_total_length] must be a scalar tensor, but got torch.Size([34])
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/a/anokhin/Open-Reasoner-Zero/playground/binary_orz_1p5b_ppo.py", line 152, in <module>
    asyncio.run(exp.run())
  File "/cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v4/Compiler/gcccore/python/3.12.4/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v4/Compiler/gcccore/python/3.12.4/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v4/Compiler/gcccore/python/3.12.4/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/a/anokhin/Open-Reasoner-Zero/orz/exps/examples/ppo/ppo_base_exp.py", line 274, in run
    await self.trainer.train()
  File "/home/a/anokhin/Open-Reasoner-Zero/orz/ppo/trainer.py", line 109, in train
    await self.make_experience(rand_prompts)
  File "/home/a/anokhin/Open-Reasoner-Zero/orz/ppo/trainer.py", line 392, in make_experience
    avg_kl_max += metrics["avg_kl_max"]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/a/anokhin/envs/reasoner3.12/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/a/anokhin/Open-Reasoner-Zero/orz/ppo/replay_buffer.py", line 334, in append
    items = split_experience_batch(experience)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/a/anokhin/Open-Reasoner-Zero/orz/ppo/replay_buffer.py", line 194, in split_experience_batch
    assert vv.numel() == 1, f"info[{k}] must be a scalar tensor, but got {vv.shape}"
           ^^^^^^^^^^^^^^^
AssertionError: info[teacher_total_length] must be a scalar tensor, but got torch.Size([34])
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: - 0.055 MB of 0.062 MB uploaded (0.000 MB deduped)wandb: \ 0.055 MB of 0.062 MB uploaded (0.000 MB deduped)wandb: | 0.055 MB of 0.062 MB uploaded (0.000 MB deduped)wandb: / 0.055 MB of 0.062 MB uploaded (0.000 MB deduped)wandb: - 0.055 MB of 0.062 MB uploaded (0.000 MB deduped)wandb: \ 0.055 MB of 0.062 MB uploaded (0.000 MB deduped)wandb: | 0.055 MB of 0.062 MB uploaded (0.000 MB deduped)wandb: / 0.055 MB of 0.062 MB uploaded (0.000 MB deduped)wandb: - 0.055 MB of 0.062 MB uploaded (0.000 MB deduped)wandb: \ 0.055 MB of 0.062 MB uploaded (0.000 MB deduped)wandb: | 0.055 MB of 0.062 MB uploaded (0.000 MB deduped)wandb: / 0.055 MB of 0.062 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:                     avg_correct_num_tokens ‚ñÅ
wandb:                   avg_incorrect_num_tokens ‚ñÅ
wandb:                         avg_non_stop_count ‚ñÅ
wandb:                             avg_num_tokens ‚ñÅ
wandb:                              avg_pass_at_n ‚ñÅ
wandb:               avg_reflection_pattern_score ‚ñÅ
wandb:                           avg_repeat_score ‚ñÅ
wandb:                        evals/eval_accuracy ‚ñÅ
wandb:             evals/strategyqa_test/accuracy ‚ñÅ
wandb: evals/strategyqa_test/response_len_in_char ‚ñÅ
wandb:                                global_step ‚ñÅ
wandb:                            grpo_raw_reward ‚ñÅ
wandb:                     std_correct_num_tokens ‚ñÅ
wandb:                   std_incorrect_num_tokens ‚ñÅ
wandb:                             std_num_tokens ‚ñÅ
wandb:                                       step ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb: 
wandb: Run summary:
wandb:                     avg_correct_num_tokens 110.7291
wandb:                   avg_incorrect_num_tokens 138.63725
wandb:                         avg_non_stop_count 0.00012
wandb:                             avg_num_tokens 121.81128
wandb:                              avg_pass_at_n 1.0
wandb:               avg_reflection_pattern_score 0.00879
wandb:                           avg_repeat_score 0.01535
wandb:                        evals/eval_accuracy 0.3115
wandb:             evals/strategyqa_test/accuracy 0.3115
wandb: evals/strategyqa_test/response_len_in_char 494.28531
wandb:                                global_step 0
wandb:                            grpo_raw_reward 0.60291
wandb:                     std_correct_num_tokens 100.2832
wandb:                   std_incorrect_num_tokens 227.0407
wandb:                             std_num_tokens 163.45932
wandb:                                       step 0
wandb: 
wandb: üöÄ View run binary_orz_1p5b_ppo_teacher-grpo-4gpu-v1 at: https://wandb.ai/irina-rish/open-reasoner-zero/runs/4qmkkzhl
wandb: Synced 5 W&B file(s), 4 media file(s), 4 artifact file(s) and 1 other file(s)
wandb: Find logs at: /home/a/anokhin/links/scratch/orz_logs/binary_orz_1p5b_ppo_teacher-grpo-4gpu-v1/wandb/run-20250724_121348-4qmkkzhl/logs
[36m(LLMActor pid=978052)[0m Processed prompts: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 172/172 [00:14<00:00,  1.25s/it, est. speed input: 2173.53 toks/s, output: 1243.88 toks/s]Processed prompts: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 172/172 [00:14<00:00, 12.00it/s, est. speed input: 2173.53 toks/s, output: 1243.88 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMActor pid=978051)[0m Processed prompts:  99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 171/172 [00:12<00:00,  1.08it/s, est. speed input: 2446.05 toks/s, output: 1474.96 toks/s][32m [repeated 2x across cluster][0m
[36m(extract_final_answers_batch pid=980806)[0m [2025-07-24 12:17:56,714] [WARNING] [real_accelerator.py:174:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[36m(extract_final_answers_batch pid=980806)[0m [2025-07-24 12:17:56,730] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[36m(LLMActor pid=978050)[0m init_process_group: master_address=10.224.3.59, master_port=59837,  rank=4, world_size=5, group_name=openrlhf[32m [repeated 3x across cluster][0m
[36m(get_reflection_pattern_score pid=980803)[0m math_verify is not installed in this environment
[36m(pid=983890)[0m [2025-07-24 12:18:00,303] [WARNING] [real_accelerator.py:174:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.[32m [repeated 14x across cluster][0m
[36m(pid=983890)[0m [2025-07-24 12:18:00,308] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cpu (auto detect)[32m [repeated 14x across cluster][0m
[36m(get_reflection_pattern_score pid=983895)[0m math_verify is not installed in this environment[32m [repeated 14x across cluster][0m
[36m(pid=985145)[0m [2025-07-24 12:18:07,293] [WARNING] [real_accelerator.py:174:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.[32m [repeated 29x across cluster][0m
[36m(pid=985145)[0m [2025-07-24 12:18:07,295] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cpu (auto detect)[32m [repeated 29x across cluster][0m
[36m(pid=985096)[0m math_verify is not installed in this environment[32m [repeated 22x across cluster][0m

======== GPU REPORT ========

==============NVSMI LOG==============

Timestamp                                 : Thu Jul 24 12:19:07 2025
Driver Version                            : 570.133.20
CUDA Version                              : 12.8

Attached GPUs                             : 4
GPU 00000000:4E:00.0
    Accounting Mode                       : Enabled
    Accounting Mode Buffer Size           : 4000
    Accounted Processes
        Process ID                        : 978753
            GPU Utilization               : 2 %
            Memory Utilization            : 1 %
            Max memory usage              : 29826 MiB
            Time                          : 267968 ms
            Is Running                    : 0
        Process ID                        : 978578
            GPU Utilization               : 2 %
            Memory Utilization            : 1 %
            Max memory usage              : 33438 MiB
            Time                          : 276243 ms
            Is Running                    : 0
        Process ID                        : 978053
            GPU Utilization               : 12 %
            Memory Utilization            : 5 %
            Max memory usage              : 36644 MiB
            Time                          : 304524 ms
            Is Running                    : 0

GPU 00000000:5F:00.0
    Accounting Mode                       : Enabled
    Accounting Mode Buffer Size           : 4000
    Accounted Processes
        Process ID                        : 979452
            GPU Utilization               : 2 %
            Memory Utilization            : 1 %
            Max memory usage              : 32802 MiB
            Time                          : 260354 ms
            Is Running                    : 0
        Process ID                        : 978051
            GPU Utilization               : 7 %
            Memory Utilization            : 3 %
            Max memory usage              : 36644 MiB
            Time                          : 303289 ms
            Is Running                    : 0
        Process ID                        : 978751
            GPU Utilization               : 3 %
            Memory Utilization            : 1 %
            Max memory usage              : 36416 MiB
            Time                          : 270874 ms
            Is Running                    : 0

GPU 00000000:CB:00.0
    Accounting Mode                       : Enabled
    Accounting Mode Buffer Size           : 4000
    Accounted Processes
        Process ID                        : 979454
            GPU Utilization               : 2 %
            Memory Utilization            : 1 %
            Max memory usage              : 29928 MiB
            Time                          : 260127 ms
            Is Running                    : 0
        Process ID                        : 978760
            GPU Utilization               : 3 %
            Memory Utilization            : 1 %
            Max memory usage              : 33542 MiB
            Time                          : 268674 ms
            Is Running                    : 0
        Process ID                        : 978052
            GPU Utilization               : 10 %
            Memory Utilization            : 4 %
            Max memory usage              : 36644 MiB
            Time                          : 303815 ms
            Is Running                    : 0

GPU 00000000:DB:00.0
    Accounting Mode                       : Enabled
    Accounting Mode Buffer Size           : 4000
    Accounted Processes
        Process ID                        : 979453
            GPU Utilization               : 3 %
            Memory Utilization            : 1 %
            Max memory usage              : 38464 MiB
            Time                          : 260211 ms
            Is Running                    : 0
        Process ID                        : 978750
            GPU Utilization               : 3 %
            Memory Utilization            : 1 %
            Max memory usage              : 42078 MiB
            Time                          : 268424 ms
            Is Running                    : 0
        Process ID                        : 978050
            GPU Utilization               : 7 %
            Memory Utilization            : 3 %
            Max memory usage              : 36644 MiB
            Time                          : 304316 ms
            Is Running                    : 0

Thu Jul 24 12:19:07 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.133.20             Driver Version: 570.133.20     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA H100 80GB HBM3          On  |   00000000:4E:00.0 Off |                    0 |
| N/A   34C    P0             97W /  700W |       0MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA H100 80GB HBM3          On  |   00000000:5F:00.0 Off |                    0 |
| N/A   33C    P0            115W /  700W |       0MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA H100 80GB HBM3          On  |   00000000:CB:00.0 Off |                    0 |
| N/A   35C    P0            120W /  700W |       0MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA H100 80GB HBM3          On  |   00000000:DB:00.0 Off |                    0 |
| N/A   35C    P0            123W /  700W |       0MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
